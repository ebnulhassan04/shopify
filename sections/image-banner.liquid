{% schema %}
  {
    "name": "Dynamic Hero Slider",
    "settings": [
      {
        "type": "header",
        "content": "General Settings"
      },
      {
        "type": "range",
        "id": "slide_height",
        "label": "Slider Height (px)",
        "default": 600,
        "min": 400,
        "max": 1000,
        "step": 10
      },
      {
        "type": "range",
        "id": "auto_slide_time",
        "label": "Auto Slide Time (seconds)",
        "default": 5,
        "min": 2,
        "max": 15,
        "step": 1
      },
      {
        "type": "checkbox",
        "id": "show_navigation",
        "label": "Show Prev/Next Buttons",
        "default": true
      }, {
        "type": "checkbox",
        "id": "show_dots",
        "label": "Show Dots Navigation",
        "default": true
      }
    ],
    "blocks": [
      {
        "type": "slide",
        "name": "Slide",
        "settings": [
          {
            "type": "image_picker",
            "id": "slide_image",
            "label": "Background Image"
          },
          {
            "type": "text",
            "id": "heading",
            "label": "Heading",
            "default": "Your Slide Heading"
          },
          {
            "type": "textarea",
            "id": "subheading",
            "label": "Subheading",
            "default": "Your Subheading or description goes here"
          },
          {
            "type": "text",
            "id": "button_text",
            "label": "Button Text",
            "default": "Shop Now"
          }, {
            "type": "url",
            "id": "button_link",
            "label": "Button Link"
          }
        ]
      }
    ],
    "presets": [
      {
        "name": "Dynamic Hero Slider",
        "category": "Hero Section"
      }
    ]
  }
{% endschema %}

{% assign total_slides = section.blocks.size %}

<section class="hero-slider" style="height: {{ section.settings.slide_height }}px;">
  <div class="slider-container">
    <div class="slides" style="height: {{ section.settings.slide_height }}px;">
      {% for block in section.blocks %}
        <div class="slide" style="background-image: url({{ block.settings.slide_image | image_url }});">
          <div class="overlay"></div>
          <div class="slide-content">
            {% if block.settings.heading != blank %}
              <h1>{{ block.settings.heading }}</h1>
            {% endif %}
            {% if block.settings.subheading != blank %}
              <p>{{ block.settings.subheading }}</p>
            {% endif %}
            {% if block.settings.button_text != blank %}
              <a href="{{ block.settings.button_link }}" class="btn">
                {{ block.settings.button_text }}
              </a>
            {% endif %}
          </div>
        </div>
      {% else %}
        <div class="slide">
          {{ 'lifestyle-1' | placeholder_svg_tag: 'placeholder-svg' }}
          <div class="overlay"></div>
          <div class="slide-content">
            <h1>Hero banner</h1>
            <p>This is the Sub heading</p>
            <a href="" class="btn">
              Button
            </a>
          </div>
        </div>
      {% endfor %}
    </div>

    <!-- Navigation Buttons -->
    {% if section.settings.show_navigation and total_slides > 1 %}
      <button class="prev">&#10094;</button>
      <button class="next">&#10095;</button>
    {% endif %}

    <!-- Dots Navigation -->
    {% if section.settings.show_dots and total_slides > 1 %}
      <div class="dots"></div>
    {% endif %}
  </div>
</section>

<style>
  .hero-slider {
    position: relative;
    width: 100%;
    overflow: hidden;
  }

  .slider-container {
    position: relative;
    height: 100%;
  }

  .slides {
    display: flex;
    width: 100%;
    height: 100%;
    transition: transform 0.6s ease-in-out;
  }

  .slide {
    min-width: 100%;
    height: 100%;
    position: relative;
    background-size: cover;
    background-position: center;
  }

  /* Overlay */
  .overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(to right, rgba(0,0,0,0.7), rgba(0,0,0,0.2));
    z-index: 1;
  }

  /* Slide Text Content */
  .slide-content {
    position: absolute;
    top: 50%;
    left: 10%;
    transform: translateY(-50%);
    z-index: 2;
    color: #fff;
    max-width: 600px;
  }

  .slide-content h1 {
    font-size: 3rem;
    margin-bottom: 15px;
    font-weight: bold;
  }

  .slide-content p {
    font-size: 1.2rem;
    margin-bottom: 20px;
  }

  .btn {
    display: inline-block;
    padding: 12px 28px;
    background: #ff6f61;
    color: white;
    text-decoration: none;
    border-radius: 50px;
    font-weight: 500;
    font-size: 1rem;
    transition: 0.3s ease;
  }

  .btn:hover {
    background: #ff3b2e;
    transform: scale(1.05);
  }

  /* Prev/Next Buttons */
  .prev,
  .next {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    background: rgba(0, 0, 0, 0.6);
    color: white;
    border: none;
    padding: 18px;
    cursor: pointer;
    border-radius: 50%;
    z-index: 10;
    font-size: 22px;
    transition: all 0.3s ease;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
  }

  .prev:hover,
  .next:hover {
    background: rgba(0, 0, 0, 0.85);
    transform: translateY(-50%) scale(1.1);
  }

  .prev {
    left: 25px;
  }
  .next {
    right: 25px;
  }

  /* Dots */
  .dots {
    position: absolute;
    bottom: 20px;
    width: 100%;
    text-align: center;
    z-index: 10;
  }

  .dot {
    height: 14px;
    width: 14px;
    margin: 0 6px;
    background-color: rgba(255, 255, 255, 0.6);
    border-radius: 50%;
    display: inline-block;
    cursor: pointer;
    transition: background-color 0.3s ease;
  }

  .dot.active {
    background-color: white;
  }
  img,
  svg {
    vertical-align: middle;
    width: 100% !important;
    height: auto;
  }
  /* Responsive */
  @media (max-width: 768px) {
    .slide-content h1 {
      font-size: 2rem;
    }
    .slide-content p {
      font-size: 1rem;
    }
    .btn {
      padding: 10px 20px;
      font-size: 0.9rem;
    }
    .prev,
    .next {
      padding: 12px;
      font-size: 18px;
    }
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    const slider = document.querySelector('.slides');
    const slides = document.querySelectorAll('.slide');
    const prevBtn = document.querySelector('.prev');
    const nextBtn = document.querySelector('.next');
    const dotsContainer = document.querySelector('.dots');
    const totalSlides = slides.length;
    const autoSlideTime = {{ section.settings.auto_slide_time | default: 5 }} * 1000;
  
    let index = 0;
  
    // Generate dots only if setting is enabled and more than 1 slide
    {% if section.settings.show_dots and total_slides > 1 %}
      slides.forEach((_, i) => {
        const dot = document.createElement('span');
        dot.classList.add('dot');
        if (i === 0) dot.classList.add('active');
        dot.addEventListener('click', () => {
          index = i;
          updateSlider();
        });
        dotsContainer.appendChild(dot);
      });
    {% endif %}
  
    const dots = document.querySelectorAll('.dot');
  
    function updateSlider() {
      slider.style.transform = `translateX(-${index * 100}%)`;
      if (dots.length > 0) {
        dots.forEach(dot => dot.classList.remove('active'));
        dots[index].classList.add('active');
      }
    }
  
    function nextSlide() {
      index = (index + 1) % totalSlides;
      updateSlider();
    }
  
    function prevSlide() {
      index = (index - 1 + totalSlides) % totalSlides;
      updateSlider();
    }
  
    // Navigation buttons only if more than 1 slide
    {% if section.settings.show_navigation and total_slides > 1 %}
      nextBtn.addEventListener('click', nextSlide);
      prevBtn.addEventListener('click', prevSlide);
    {% endif %}
  
    // Auto slide only if more than 1 slide
    if (totalSlides > 1) {
      setInterval(nextSlide, autoSlideTime);
    }
  });
</script>